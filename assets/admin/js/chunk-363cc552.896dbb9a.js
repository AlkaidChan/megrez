(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-363cc552"],{1724:function(t,e,i){},2055:function(t,e,i){"use strict";i("274c")},"274c":function(t,e,i){},3330:function(t,e,i){"use strict";i("1724")},"71fc":function(t,e,i){},a434:function(t,e,i){"use strict";var n=i("23e7"),s=i("da84"),a=i("23cb"),c=i("5926"),o=i("07fa"),l=i("7b0b"),r=i("65f0"),u=i("8418"),h=i("1dde"),d=h("splice"),f=s.TypeError,m=Math.max,p=Math.min,b=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d},{splice:function(t,e){var i,n,s,h,d,g,y=l(this),w=o(y),k=a(t,w),x=arguments.length;if(0===x?i=n=0:1===x?(i=0,n=w-k):(i=x-2,n=p(m(c(e),0),w-k)),w+i-n>b)throw f(v);for(s=r(y,n),h=0;h<n;h++)d=k+h,d in y&&u(s,h,y[d]);if(s.length=n,i<n){for(h=k;h<w-n;h++)d=h+n,g=h+i,d in y?y[g]=y[d]:delete y[g];for(h=w;h>w-n+i;h--)delete y[h-1]}else if(i>n)for(h=w-n;h>k;h--)d=h+n-1,g=h+i-1,d in y?y[g]=y[d]:delete y[g];for(h=0;h<i;h++)y[h+k]=arguments[h+2];return y.length=w-n+i,s}})},f06c:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("t-drawer",{attrs:{header:"附件列表",visible:t.visible,onClose:t.close,closeBtn:!0,size:"400px",zIndex:2600,onOverlayClick:t.close,placement:"right"},scopedSlots:t._u([{key:"footer",fn:function(){return[i("t-button",{on:{click:t.onClickUpload}},[i("UploadIcon",{attrs:{slot:"icon"},slot:"icon"}),t._v(" 上传附件 ")],1),"multiple"===t.mode?i("span",{staticClass:"complete-button"},[t.selectedAttaches.length>0?i("t-button",{attrs:{theme:"danger"},on:{click:t.onClickComplete}},[t._v(" 完成 ")]):i("t-button",{attrs:{theme:"danger",disabled:""}},[t._v("完成")])],1):t._e()]},proxy:!0}])},[i("div",{staticClass:"images-wrapper"},t._l(t.attachments,(function(e,n){return i("div",{key:e.id,staticClass:"image-item",style:t.selectedIndex[n]?{border:"5px solid #1890ff"}:{},on:{click:function(i){return t.handleSelect(e,n)},mouseenter:function(e){return t.mouseEnter(n)},mouseleave:function(e){return t.mouseLeave(n)}}},[i("img",{attrs:{src:e.url}}),i("div",{directives:[{name:"show",rawName:"v-show",value:t.maskVisible[n],expression:"maskVisible[index]"}],staticClass:"image-item-mask"},[i("div",{on:{click:function(i){return i.stopPropagation(),t.handlePreview(e)}}},[i("BrowseIcon",{staticStyle:{cursor:"pointer"}})],1),i("t-divider",{attrs:{layout:"vertical"}}),i("div",{on:{click:function(i){return i.stopPropagation(),t.handleDetail(e)}}},[i("InfoCircleIcon",{staticStyle:{cursor:"pointer"}})],1)],1)])})),0)]),i("AttachDetailDrawer",{ref:"attachDetailDrawer"}),i("AttachUploadDialog",{ref:"attachUploadDialog",on:{uploadSuccess:t.syncData}})],1)},s=[],a=(i("d81d"),i("a434"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("t-dialog",{attrs:{visible:t.visible,header:null,confirmBtn:null,cancelBtn:null,onClose:t.close,zIndex:2601}},[i("div",{staticClass:"upload-container"},[i("t-upload",{attrs:{theme:"image",onSuccess:t.handleUploadSuccess,onFail:t.handleUploadFail,requestMethod:t.uploadMethod,draggable:"",accept:"image/*"},model:{value:t.files,callback:function(e){t.files=e},expression:"files"}})],1)])}),c=[],o=(i("d3b7"),{name:"AttachUploadDialog",data:function(){return{visible:!1,files:[]}},computed:{},methods:{open:function(){this.visible=!0},close:function(){this.visible=!1},handleUploadFail:function(){this.$message.error("上传失败")},handleUploadSuccess:function(){this.$message.success("上传成功"),this.$emit("uploadSuccess"),this.files=[],this.close()},uploadMethod:function(t){var e=this;return new Promise((function(i){t.percent=0;var n=new FormData;n.append("file",t.raw),e.$request.post("upload",n,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){0===t.status&&i({status:"success",response:{url:t.data.url}})})).catch((function(){i({status:"fail",error:"上传失败，请检查文件是否符合规范"})}))}))}}}),l=o,r=(i("2055"),i("2877")),u=Object(r["a"])(l,a,c,!1,null,"65d582b0",null),h=u.exports,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("t-drawer",{attrs:{header:"附件详情",visible:t.visible,onClose:t.close,closeBtn:!0,size:"480px",zIndex:2600,onOverlayClick:t.close,placement:"right"},scopedSlots:t._u([{key:"footer",fn:function(){return[i("t-button",{on:{click:t.deleteAttach}},[t._v("删除")])]},proxy:!0}])},[t.attachment?i("t-list",{attrs:{split:!0}},[i("t-list-item",[i("t-list-item-meta",{attrs:{title:"附件名"}}),t._v(" "+t._s(t.attachment.fileName)+" ")],1),i("t-list-item",[i("t-list-item-meta",{attrs:{title:"存储位置"}}),t._v(" "+t._s(t.attachmentStorageType)+" ")],1),i("t-list-item",[i("t-list-item-meta",{attrs:{title:"图片大小"}}),t._v(" "+t._s(t.attachment.size)+" ")],1),i("t-list-item",[i("t-list-item-meta",{attrs:{title:"图片尺寸"}}),t._v(" "+t._s(t.attachment.height)+" x "+t._s(t.attachment.width)+" ")],1),i("t-list-item",[i("t-list-item-meta",{attrs:{title:"上传日期"}}),t._v(" "+t._s(t.attachment.uploadTime)+" ")],1),i("t-list-item",{scopedSlots:t._u([{key:"action",fn:function(){return[i("t-button",{attrs:{variant:"text",shape:"square"},on:{click:t.copyURL}},[i("file-copy-icon")],1)]},proxy:!0}],null,!1,320530126)},[i("t-list-item-meta",{attrs:{title:"图片链接"}}),t._v(" "+t._s(t.attachment.url)+" ")],1),i("t-list-item",{scopedSlots:t._u([{key:"action",fn:function(){return[i("t-button",{attrs:{variant:"text",shape:"square"},on:{click:t.copyMarkdown}},[i("file-copy-icon")],1)]},proxy:!0}],null,!1,765174242)},[i("t-list-item-meta",{attrs:{title:"Markdown 链接"}}),t._v(" !["+t._s(t.attachment.fileName)+"]("+t._s(t.attachment.url)+") ")],1)],1):t._e()],1)],1)},f=[],m=(i("99af"),i("4630")),p={name:"AttachDetailDrawer",data:function(){return{attachment:{},visible:!1}},computed:{attachmentStorageType:function(){switch(this.attachment.type){case 0:return"本地";default:return"未知"}}},methods:{open:function(t){this.visible=!0,this.attachment=t},close:function(){this.visible=!1},deleteAttach:function(){this.$message.info("未实现")},copyURL:function(){this.$copyText(this.attachment.url),this.$message.success("已复制")},copyMarkdown:function(){this.$copyText("![".concat(this.attachment.fileName,"](").concat(this.attachment.url,")")),this.$message.success("已复制")}},components:{FileCopyIcon:m["a"]}},b=p,v=(i("3330"),Object(r["a"])(b,d,f,!1,null,"6fcb340a",null)),g=v.exports,y=i("87eb"),w=i("c09c"),k=i("2b0e"),x=i("b25f"),_=i("6be3"),O=(i("4d26"),i("febf"),["size"]);function D(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function C(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?D(Object(i),!0).forEach((function(e){Object(y["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):D(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var $={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M7.5 12V6.5h1V12h-1zM8.6 4H7.4v1.2h1.2V4z",fillOpacity:.9}},{tag:"path",attrs:{fill:"currentColor",d:"M1 8a7 7 0 1014 0A7 7 0 001 8zm1 0a6 6 0 1112 0A6 6 0 012 8z",fillOpacity:.9}}]},I=k["default"].extend({name:"InfoCircleIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(t,e){var i=e.props,n=e.data,s=i.size,a=Object(w["a"])(i,O),c=Object(_["a"])(s),o=c.className,l=c.style,r=C(C({},a||{}),{},{id:"info-circle",icon:$,staticClass:o,style:l});return n.props=r,t(x["a"],n)}}),A=i("4abd"),S=i("abb0"),j={name:"AttachSelectDrawer",data:function(){return{num:0,visible:!1,attachments:[],maskVisible:[],selectedIndex:[],selectedAttaches:[]}},props:{mode:{type:String,required:!1,default:"single"}},methods:{open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.num=t,this.visible=!0},close:function(){this.visible=!1,this.selectedIndex=this.selectedIndex.map((function(){return!1})),this.selectedAttaches=[]},onClickUpload:function(){this.$refs.attachUploadDialog.open()},syncData:function(){var t=this;this.$request.get("attachments").then((function(e){0===e.status&&(t.attachments=e.data.list?e.data.list:[]),t.maskVisible=t.attachments.map((function(){return!1})),t.selectedIndex=t.attachments.map((function(){return!1}))})).catch((function(){t.$message.error("获取附件列表失败")}))},mouseEnter:function(t){this.$set(this.maskVisible,t,!0)},mouseLeave:function(t){this.$set(this.maskVisible,t,!1)},handleDetail:function(t){this.$refs.attachDetailDrawer.open(t)},handlePreview:function(t){this.$viewerApi({images:[t.url]})},handleSelect:function(t,e){"single"===this.mode&&(this.$emit("select",t),this.close()),0!=this.num&&this.num<=this.selectedAttaches.length?this.$message.warning("最多只能选择"+this.num+"个附件"):(this.$set(this.selectedIndex,e,!this.selectedIndex[e]),this.selectedIndex[e]?this.selectedAttaches.push(t):this.selectedAttaches.splice(this.selectedAttaches.indexOf(t),1))},onClickComplete:function(){this.$emit("select",this.selectedAttaches),this.close()}},mounted:function(){this.syncData()},components:{AttachUploadDialog:h,AttachDetailDrawer:g,InfoCircleIcon:I,BrowseIcon:A["a"],UploadIcon:S["a"]}},U=j,z=(i("fe41"),Object(r["a"])(U,n,s,!1,null,"4ab3db0b",null));e["a"]=z.exports},fe41:function(t,e,i){"use strict";i("71fc")}}]);
//# sourceMappingURL=chunk-363cc552.896dbb9a.js.map